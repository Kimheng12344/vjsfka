<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Camera Object Detection</title>
</head>
<body>
<h1>Camera Object Detection</h1>
<video id="videoElement" width="640" height="480" autoplay></video>
<canvas id="outputCanvas" width="640" height="480"></canvas>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
<script>
  async function startCamera() {
    const videoElement = document.getElementById('videoElement');

    try {
      // Request access to the camera
      const stream = await navigator.mediaDevices.getUserMedia({ video: true });
      videoElement.srcObject = stream;

      // Load the COCO-SSD model
      const model = await cocoSsd.load();

      // Perform object detection on each video frame
      videoElement.addEventListener('loadeddata', async () => {
        const outputCanvas = document.getElementById('outputCanvas');
        const ctx = outputCanvas.getContext('2d');

        outputCanvas.width = videoElement.videoWidth;
        outputCanvas.height = videoElement.videoHeight;

        // Continuously detect objects and draw bounding boxes
        setInterval(async () => {
          const predictions = await model.detect(videoElement);
          ctx.clearRect(0, 0, outputCanvas.width, outputCanvas.height);

          predictions.forEach(prediction => {
            ctx.beginPath();
            ctx.lineWidth = '2';
            ctx.strokeStyle = 'red';
            ctx.rect(...prediction.bbox);
            ctx.stroke();
            ctx.font = '16px Arial';
            ctx.fillStyle = 'red';
            ctx.fillText(`${prediction.class} (${Math.round(prediction.score * 100)}%)`, prediction.bbox[0], prediction.bbox[1] - 5);
          });
        }, 1000 / 30); // 30 FPS
      });
    } catch (error) {
      console.error('Error accessing the camera:', error);
    }
  }
</script>
<button onclick="startCamera()">Start Camera</button>
</body>
</html>
